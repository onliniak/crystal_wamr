crystal_doc_search_index_callback({"repository_name":"crystal_wamr","body":"# crystal_wamr\n\nTODO: Write a description here\n\nBindings to [WAMR](https://github.com/bytecodealliance/wasm-micro-runtime).\nTested with 1.2.3\n\nFor production apps use https://github.com/naqvis/wasmer-crystal\n\nWhy? I wanted to have user-submitted functions on free hosting without sudo, but with SSH.\n\n## Installation\n\n1. Add the dependency to your `shard.yml`:\n\n   ```yaml\n   dependencies:\n     crystal_wamr:\n       github: onliniak/crystal_wamr\n   ```\n\n2. Run `shards install`\n\n## Usage\n\n```crystal\nrequire \"crystal_wamr\"\n\nwasm = CrystalWamr::WASM.new\n\nargv = Array(Int32).new\nargv << 8\np wasm.exec(File.read(\"fib.wasm\"), \"fib\", argv) # => fib function return: 21\n\nargv = Array(Int32).new\nargv << 2\nargv << 3\np wasm.exec(File.read(\"math.wasm\"), \"pow\", argv, \"This is my custom message\") # => This is my custom message 8\n```\n\nTODO: Write usage instructions here\n\n## Known Issues\n\n### Invalid memory access (signal 11) at address 0x0\n\nUse https://github.com/naqvis/wasmer-crystal\nIf you are using AOT make sure wamrc is in the same version as iwasm\n\nFor some reason grain lang and TinyGO reject argv array.\n[c4WA](https://github.com/kign/c4wa) works. I haven't checked emscripten but it likely works.\n\n### AssemblyScript: \"Exception: failed to call unlinked import function (env, abort)\".\n\nhttps://github.com/bytecodealliance/wasm-micro-runtime/issues/510\n\n### Strings\n\nIt seems that on the default settings you can not return array. Only single numeric value. But I could be wrong. \nEDIT: https://github.com/bytecodealliance/wasm-micro-runtime/issues/263\n\n## Development\n\nTODO: Write development instructions here\n\n## Contributing\n\n1. Fork it (<https://github.com/onliniak/crystal_wamr/fork>)\n2. Create your feature branch (`git checkout -b my-new-feature`)\n3. Commit your changes (`git commit -am 'Add some feature'`)\n4. Push to the branch (`git push origin my-new-feature`)\n5. Create a new Pull Request\n\n## Contributors\n\n- [Rafael Pszenny](https://github.com/onliniak) - creator and maintainer\n","program":{"html_id":"crystal_wamr/toplevel","path":"toplevel.html","kind":"module","full_name":"Top Level Namespace","name":"Top Level Namespace","abstract":false,"locations":[],"repository_name":"crystal_wamr","program":true,"enum":false,"alias":false,"const":false,"types":[{"html_id":"crystal_wamr/CrystalWamr","path":"CrystalWamr.html","kind":"module","full_name":"CrystalWamr","name":"CrystalWamr","abstract":false,"locations":[{"filename":"src/crystal_wamr.cr","line_number":4,"url":null},{"filename":"src/crystal_wamr_config.cr","line_number":3,"url":null}],"repository_name":"crystal_wamr","program":false,"enum":false,"alias":false,"const":false,"constants":[{"id":"VERSION","name":"VERSION","value":"\"0.1.0\""}],"doc":"TODO: Write documentation for `CrystalWamr`","summary":"<p><span class=\"flag orange\">TODO</span>  Write documentation for <code><a href=\"CrystalWamr.html\">CrystalWamr</a></code></p>","types":[{"html_id":"crystal_wamr/CrystalWamr/Argv","path":"CrystalWamr/Argv.html","kind":"class","full_name":"CrystalWamr::Argv","name":"Argv","abstract":false,"superclass":{"html_id":"crystal_wamr/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"crystal_wamr/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"crystal_wamr/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"crystal_wamr/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/crystal_wamr_config.cr","line_number":24,"url":null}],"repository_name":"crystal_wamr","program":false,"enum":false,"alias":false,"const":false,"included_modules":[{"html_id":"crystal_wamr/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"}],"namespace":{"html_id":"crystal_wamr/CrystalWamr","kind":"module","full_name":"CrystalWamr","name":"CrystalWamr"},"constructors":[{"html_id":"new(pull:JSON::PullParser)-class-method","name":"new","abstract":false,"args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","args_html":"(pull : JSON::PullParser)","location":{"filename":"src/crystal_wamr_config.cr","line_number":25,"url":null},"def":{"name":"new","args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"visibility":"Public","body":"new_from_json_pull_parser(pull)"}}],"instance_methods":[{"html_id":"int:Int32|Nil-instance-method","name":"int","abstract":false,"location":{"filename":"src/crystal_wamr_config.cr","line_number":27,"url":null},"def":{"name":"int","return_type":"Int32 | ::Nil","visibility":"Public","body":"@int"}},{"html_id":"int=(int:Int32|Nil)-instance-method","name":"int=","abstract":false,"args":[{"name":"int","external_name":"int","restriction":"Int32 | ::Nil"}],"args_string":"(int : Int32 | Nil)","args_html":"(int : Int32 | Nil)","location":{"filename":"src/crystal_wamr_config.cr","line_number":27,"url":null},"def":{"name":"int=","args":[{"name":"int","external_name":"int","restriction":"Int32 | ::Nil"}],"visibility":"Public","body":"@int = int"}},{"html_id":"sys:Sys|Nil-instance-method","name":"sys","abstract":false,"location":{"filename":"src/crystal_wamr_config.cr","line_number":29,"url":null},"def":{"name":"sys","return_type":"Sys | ::Nil","visibility":"Public","body":"@sys"}},{"html_id":"sys=(sys:Sys|Nil)-instance-method","name":"sys=","abstract":false,"args":[{"name":"sys","external_name":"sys","restriction":"Sys | ::Nil"}],"args_string":"(sys : Sys | Nil)","args_html":"(sys : <a href=\"../CrystalWamr/Sys.html\">Sys</a> | Nil)","location":{"filename":"src/crystal_wamr_config.cr","line_number":29,"url":null},"def":{"name":"sys=","args":[{"name":"sys","external_name":"sys","restriction":"Sys | ::Nil"}],"visibility":"Public","body":"@sys = sys"}},{"html_id":"var:String|Nil-instance-method","name":"var","abstract":false,"location":{"filename":"src/crystal_wamr_config.cr","line_number":28,"url":null},"def":{"name":"var","return_type":"String | ::Nil","visibility":"Public","body":"@var"}},{"html_id":"var=(var:String|Nil)-instance-method","name":"var=","abstract":false,"args":[{"name":"var","external_name":"var","restriction":"String | ::Nil"}],"args_string":"(var : String | Nil)","args_html":"(var : String | Nil)","location":{"filename":"src/crystal_wamr_config.cr","line_number":28,"url":null},"def":{"name":"var=","args":[{"name":"var","external_name":"var","restriction":"String | ::Nil"}],"visibility":"Public","body":"@var = var"}}]},{"html_id":"crystal_wamr/CrystalWamr/Func","path":"CrystalWamr/Func.html","kind":"class","full_name":"CrystalWamr::Func","name":"Func","abstract":false,"superclass":{"html_id":"crystal_wamr/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"crystal_wamr/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"crystal_wamr/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"crystal_wamr/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/crystal_wamr_config.cr","line_number":11,"url":null}],"repository_name":"crystal_wamr","program":false,"enum":false,"alias":false,"const":false,"included_modules":[{"html_id":"crystal_wamr/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"}],"namespace":{"html_id":"crystal_wamr/CrystalWamr","kind":"module","full_name":"CrystalWamr","name":"CrystalWamr"},"constructors":[{"html_id":"new(pull:JSON::PullParser)-class-method","name":"new","abstract":false,"args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","args_html":"(pull : JSON::PullParser)","location":{"filename":"src/crystal_wamr_config.cr","line_number":12,"url":null},"def":{"name":"new","args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"visibility":"Public","body":"new_from_json_pull_parser(pull)"}}],"instance_methods":[{"html_id":"input:Array(Input)-instance-method","name":"input","abstract":false,"location":{"filename":"src/crystal_wamr_config.cr","line_number":15,"url":null},"def":{"name":"input","return_type":"Array(Input)","visibility":"Public","body":"@input"}},{"html_id":"input=(input:Array(Input))-instance-method","name":"input=","abstract":false,"args":[{"name":"input","external_name":"input","restriction":"Array(Input)"}],"args_string":"(input : Array(Input))","args_html":"(input : Array(<a href=\"../CrystalWamr/Input.html\">Input</a>))","location":{"filename":"src/crystal_wamr_config.cr","line_number":15,"url":null},"def":{"name":"input=","args":[{"name":"input","external_name":"input","restriction":"Array(Input)"}],"visibility":"Public","body":"@input = input"}},{"html_id":"name:String-instance-method","name":"name","abstract":false,"location":{"filename":"src/crystal_wamr_config.cr","line_number":14,"url":null},"def":{"name":"name","return_type":"String","visibility":"Public","body":"@name"}},{"html_id":"name=(name:String)-instance-method","name":"name=","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"}],"args_string":"(name : String)","args_html":"(name : String)","location":{"filename":"src/crystal_wamr_config.cr","line_number":14,"url":null},"def":{"name":"name=","args":[{"name":"name","external_name":"name","restriction":"String"}],"visibility":"Public","body":"@name = name"}}]},{"html_id":"crystal_wamr/CrystalWamr/Input","path":"CrystalWamr/Input.html","kind":"class","full_name":"CrystalWamr::Input","name":"Input","abstract":false,"superclass":{"html_id":"crystal_wamr/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"crystal_wamr/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"crystal_wamr/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"crystal_wamr/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/crystal_wamr_config.cr","line_number":18,"url":null}],"repository_name":"crystal_wamr","program":false,"enum":false,"alias":false,"const":false,"included_modules":[{"html_id":"crystal_wamr/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"}],"namespace":{"html_id":"crystal_wamr/CrystalWamr","kind":"module","full_name":"CrystalWamr","name":"CrystalWamr"},"constructors":[{"html_id":"new(pull:JSON::PullParser)-class-method","name":"new","abstract":false,"args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","args_html":"(pull : JSON::PullParser)","location":{"filename":"src/crystal_wamr_config.cr","line_number":19,"url":null},"def":{"name":"new","args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"visibility":"Public","body":"new_from_json_pull_parser(pull)"}}],"instance_methods":[{"html_id":"argv:Argv-instance-method","name":"argv","abstract":false,"location":{"filename":"src/crystal_wamr_config.cr","line_number":21,"url":null},"def":{"name":"argv","return_type":"Argv","visibility":"Public","body":"@argv"}},{"html_id":"argv=(argv:Argv)-instance-method","name":"argv=","abstract":false,"args":[{"name":"argv","external_name":"argv","restriction":"Argv"}],"args_string":"(argv : Argv)","args_html":"(argv : <a href=\"../CrystalWamr/Argv.html\">Argv</a>)","location":{"filename":"src/crystal_wamr_config.cr","line_number":21,"url":null},"def":{"name":"argv=","args":[{"name":"argv","external_name":"argv","restriction":"Argv"}],"visibility":"Public","body":"@argv = argv"}}]},{"html_id":"crystal_wamr/CrystalWamr/Sys","path":"CrystalWamr/Sys.html","kind":"class","full_name":"CrystalWamr::Sys","name":"Sys","abstract":false,"superclass":{"html_id":"crystal_wamr/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"crystal_wamr/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"crystal_wamr/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"crystal_wamr/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/crystal_wamr_config.cr","line_number":32,"url":null}],"repository_name":"crystal_wamr","program":false,"enum":false,"alias":false,"const":false,"included_modules":[{"html_id":"crystal_wamr/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"}],"namespace":{"html_id":"crystal_wamr/CrystalWamr","kind":"module","full_name":"CrystalWamr","name":"CrystalWamr"},"constructors":[{"html_id":"new(pull:JSON::PullParser)-class-method","name":"new","abstract":false,"args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","args_html":"(pull : JSON::PullParser)","location":{"filename":"src/crystal_wamr_config.cr","line_number":33,"url":null},"def":{"name":"new","args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"visibility":"Public","body":"new_from_json_pull_parser(pull)"}}],"instance_methods":[{"html_id":"argv:Array(Int32)-instance-method","name":"argv","abstract":false,"location":{"filename":"src/crystal_wamr_config.cr","line_number":36,"url":null},"def":{"name":"argv","return_type":"Array(Int32)","visibility":"Public","body":"@argv"}},{"html_id":"argv=(argv:Array(Int32))-instance-method","name":"argv=","abstract":false,"args":[{"name":"argv","external_name":"argv","restriction":"Array(Int32)"}],"args_string":"(argv : Array(Int32))","args_html":"(argv : Array(Int32))","location":{"filename":"src/crystal_wamr_config.cr","line_number":36,"url":null},"def":{"name":"argv=","args":[{"name":"argv","external_name":"argv","restriction":"Array(Int32)"}],"visibility":"Public","body":"@argv = argv"}},{"html_id":"name:String-instance-method","name":"name","abstract":false,"location":{"filename":"src/crystal_wamr_config.cr","line_number":35,"url":null},"def":{"name":"name","return_type":"String","visibility":"Public","body":"@name"}},{"html_id":"name=(name:String)-instance-method","name":"name=","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"}],"args_string":"(name : String)","args_html":"(name : String)","location":{"filename":"src/crystal_wamr_config.cr","line_number":35,"url":null},"def":{"name":"name=","args":[{"name":"name","external_name":"name","restriction":"String"}],"visibility":"Public","body":"@name = name"}}]},{"html_id":"crystal_wamr/CrystalWamr/WamrConfig","path":"CrystalWamr/WamrConfig.html","kind":"class","full_name":"CrystalWamr::WamrConfig","name":"WamrConfig","abstract":false,"superclass":{"html_id":"crystal_wamr/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"crystal_wamr/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"crystal_wamr/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"crystal_wamr/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/crystal_wamr_config.cr","line_number":4,"url":null}],"repository_name":"crystal_wamr","program":false,"enum":false,"alias":false,"const":false,"included_modules":[{"html_id":"crystal_wamr/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"}],"namespace":{"html_id":"crystal_wamr/CrystalWamr","kind":"module","full_name":"CrystalWamr","name":"CrystalWamr"},"constructors":[{"html_id":"new(pull:JSON::PullParser)-class-method","name":"new","abstract":false,"args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","args_html":"(pull : JSON::PullParser)","location":{"filename":"src/crystal_wamr_config.cr","line_number":5,"url":null},"def":{"name":"new","args":[{"name":"pull","external_name":"pull","restriction":"::JSON::PullParser"}],"visibility":"Public","body":"new_from_json_pull_parser(pull)"}}],"instance_methods":[{"html_id":"file:String-instance-method","name":"file","abstract":false,"location":{"filename":"src/crystal_wamr_config.cr","line_number":7,"url":null},"def":{"name":"file","return_type":"String","visibility":"Public","body":"@file"}},{"html_id":"file=(file:String)-instance-method","name":"file=","abstract":false,"args":[{"name":"file","external_name":"file","restriction":"String"}],"args_string":"(file : String)","args_html":"(file : String)","location":{"filename":"src/crystal_wamr_config.cr","line_number":7,"url":null},"def":{"name":"file=","args":[{"name":"file","external_name":"file","restriction":"String"}],"visibility":"Public","body":"@file = file"}},{"html_id":"func:Array(Func)-instance-method","name":"func","abstract":false,"location":{"filename":"src/crystal_wamr_config.cr","line_number":8,"url":null},"def":{"name":"func","return_type":"Array(Func)","visibility":"Public","body":"@func"}},{"html_id":"func=(func:Array(Func))-instance-method","name":"func=","abstract":false,"args":[{"name":"func","external_name":"func","restriction":"Array(Func)"}],"args_string":"(func : Array(Func))","args_html":"(func : Array(<a href=\"../CrystalWamr/Func.html\">Func</a>))","location":{"filename":"src/crystal_wamr_config.cr","line_number":8,"url":null},"def":{"name":"func=","args":[{"name":"func","external_name":"func","restriction":"Array(Func)"}],"visibility":"Public","body":"@func = func"}}]},{"html_id":"crystal_wamr/CrystalWamr/WASM","path":"CrystalWamr/WASM.html","kind":"class","full_name":"CrystalWamr::WASM","name":"WASM","abstract":false,"superclass":{"html_id":"crystal_wamr/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"crystal_wamr/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"crystal_wamr/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/crystal_wamr.cr","line_number":7,"url":null}],"repository_name":"crystal_wamr","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"crystal_wamr/CrystalWamr","kind":"module","full_name":"CrystalWamr","name":"CrystalWamr"},"instance_methods":[{"html_id":"add_to_hash(name,value)-instance-method","name":"add_to_hash","abstract":false,"args":[{"name":"name","external_name":"name","restriction":""},{"name":"value","external_name":"value","restriction":""}],"args_string":"(name, value)","args_html":"(name, value)","location":{"filename":"src/crystal_wamr.cr","line_number":30,"url":null},"def":{"name":"add_to_hash","args":[{"name":"name","external_name":"name","restriction":""},{"name":"value","external_name":"value","restriction":""}],"visibility":"Public","body":"@hash[name] = value"}},{"html_id":"exec(wasm_file:String,functions=Hash(String,Array(Int32)).new,output=Hash(String,String).new)-instance-method","name":"exec","abstract":false,"args":[{"name":"wasm_file","external_name":"wasm_file","restriction":"String"},{"name":"functions","default_value":"Hash(String, Array(Int32)).new","external_name":"functions","restriction":""},{"name":"output","default_value":"Hash(String, String).new","external_name":"output","restriction":""}],"args_string":"(wasm_file : String, functions = Hash(String, Array(Int32)).new, output = Hash(String, String).new)","args_html":"(wasm_file : String, functions = <span class=\"t\">Hash</span>(<span class=\"t\">String</span>, <span class=\"t\">Array</span>(<span class=\"t\">Int32</span>)).new, output = <span class=\"t\">Hash</span>(<span class=\"t\">String</span>, <span class=\"t\">String</span>).new)","location":{"filename":"src/crystal_wamr.cr","line_number":122,"url":null},"def":{"name":"exec","args":[{"name":"wasm_file","external_name":"wasm_file","restriction":"String"},{"name":"functions","default_value":"Hash(String, Array(Int32)).new","external_name":"functions","restriction":""},{"name":"output","default_value":"Hash(String, String).new","external_name":"output","restriction":""}],"visibility":"Public","body":"LibWasm.wasm_runtime_init\nmymodule = LibWasm.wasm_runtime_load(wasm_file, wasm_file.size, \"\", 0)\nmodule_inst = LibWasm.wasm_runtime_instantiate(mymodule, 8092, 8092, \"\", 0)\nfunctions.each do |x, argv|\n  if output.has_key?(x)\n    a = output[x]\n    argv << @hash[a]\n  end\n  function = LibWasm.wasm_runtime_lookup_function(module_inst, x, \"\")\n  exec_env = LibWasm.wasm_runtime_create_exec_env(module_inst, 8092)\n  if LibWasm.wasm_runtime_call_wasm(exec_env, function, argv.size, argv)\n    add_to_hash(x, argv[0])\n  else\n    LibWasm.wasm_runtime_get_exception(module_inst)\n  end\n  functions.delete(x)\nend\nexec_env = LibWasm.wasm_runtime_create_exec_env(module_inst, 8092)\nLibWasm.wasm_runtime_destroy_exec_env(exec_env)\nLibWasm.wasm_runtime_deinstantiate(module_inst)\nLibWasm.wasm_runtime_unload(mymodule)\nLibWasm.wasm_runtime_destroy\n"}},{"html_id":"exec_json(config:CrystalWamr::WamrConfig,path:String,functions=Hash(String,Array(Int32)).new,output=Hash(String,String).new)-instance-method","name":"exec_json","abstract":false,"args":[{"name":"config","external_name":"config","restriction":"CrystalWamr::WamrConfig"},{"name":"path","external_name":"path","restriction":"String"},{"name":"functions","default_value":"Hash(String, Array(Int32)).new","external_name":"functions","restriction":""},{"name":"output","default_value":"Hash(String, String).new","external_name":"output","restriction":""}],"args_string":"(config : CrystalWamr::WamrConfig, path : String, functions = Hash(String, Array(Int32)).new, output = Hash(String, String).new)","args_html":"(config : <a href=\"../CrystalWamr/WamrConfig.html\">CrystalWamr::WamrConfig</a>, path : String, functions = <span class=\"t\">Hash</span>(<span class=\"t\">String</span>, <span class=\"t\">Array</span>(<span class=\"t\">Int32</span>)).new, output = <span class=\"t\">Hash</span>(<span class=\"t\">String</span>, <span class=\"t\">String</span>).new)","location":{"filename":"src/crystal_wamr.cr","line_number":84,"url":null},"def":{"name":"exec_json","args":[{"name":"config","external_name":"config","restriction":"CrystalWamr::WamrConfig"},{"name":"path","external_name":"path","restriction":"String"},{"name":"functions","default_value":"Hash(String, Array(Int32)).new","external_name":"functions","restriction":""},{"name":"output","default_value":"Hash(String, String).new","external_name":"output","restriction":""}],"visibility":"Public","body":"config.func.map do |i|\n  functions[i.name] = [] of Int32\n  i.input.map do |x|\n    function_args(x.argv.int, x.argv.var, x.argv.sys, functions, i.name, output, path)\n  end\nend\nexec(File.read(config.file), functions, output)\n"}},{"html_id":"exec_once(wasm_file:String,function_name:String,argv:Array(Int32))-instance-method","name":"exec_once","abstract":false,"args":[{"name":"wasm_file","external_name":"wasm_file","restriction":"String"},{"name":"function_name","external_name":"function_name","restriction":"String"},{"name":"argv","external_name":"argv","restriction":"Array(Int32)"}],"args_string":"(wasm_file : String, function_name : String, argv : Array(Int32))","args_html":"(wasm_file : String, function_name : String, argv : Array(Int32))","location":{"filename":"src/crystal_wamr.cr","line_number":92,"url":null},"def":{"name":"exec_once","args":[{"name":"wasm_file","external_name":"wasm_file","restriction":"String"},{"name":"function_name","external_name":"function_name","restriction":"String"},{"name":"argv","external_name":"argv","restriction":"Array(Int32)"}],"visibility":"Public","body":"LibWasm.wasm_runtime_init\nmymodule = LibWasm.wasm_runtime_load(wasm_file, wasm_file.size, \"\", 0)\nmodule_inst = LibWasm.wasm_runtime_instantiate(mymodule, 8092, 8092, \"\", 0)\nfunc = LibWasm.wasm_runtime_lookup_function(module_inst, function_name, \"\")\nexec_env = LibWasm.wasm_runtime_create_exec_env(module_inst, 8092)\nif LibWasm.wasm_runtime_call_wasm(exec_env, func, argv.size, argv)\n  return argv[0]\nelse\n  LibWasm.wasm_runtime_get_exception(module_inst)\nend\nLibWasm.wasm_runtime_destroy_exec_env(exec_env)\nLibWasm.wasm_runtime_deinstantiate(module_inst)\nLibWasm.wasm_runtime_unload(mymodule)\nLibWasm.wasm_runtime_destroy\n"}},{"html_id":"function_args(value:Int32,variable:String|Nil,sys,functions,index,output,path)-instance-method","name":"function_args","abstract":false,"args":[{"name":"value","external_name":"value","restriction":"Int32"},{"name":"variable","external_name":"variable","restriction":"String | ::Nil"},{"name":"sys","external_name":"sys","restriction":""},{"name":"functions","external_name":"functions","restriction":""},{"name":"index","external_name":"index","restriction":""},{"name":"output","external_name":"output","restriction":""},{"name":"path","external_name":"path","restriction":""}],"args_string":"(value : Int32, variable : String | Nil, sys, functions, index, output, path)","args_html":"(value : Int32, variable : String | Nil, sys, functions, index, output, path)","location":{"filename":"src/crystal_wamr.cr","line_number":55,"url":null},"def":{"name":"function_args","args":[{"name":"value","external_name":"value","restriction":"Int32"},{"name":"variable","external_name":"variable","restriction":"String | ::Nil"},{"name":"sys","external_name":"sys","restriction":""},{"name":"functions","external_name":"functions","restriction":""},{"name":"index","external_name":"index","restriction":""},{"name":"output","external_name":"output","restriction":""},{"name":"path","external_name":"path","restriction":""}],"visibility":"Public","body":"functions[index] << value"}},{"html_id":"function_args(value:Nil,variable:String,sys:CrystalWamr::Sys,functions,index,output,path)-instance-method","name":"function_args","abstract":false,"args":[{"name":"value","external_name":"value","restriction":"Nil"},{"name":"variable","external_name":"variable","restriction":"String"},{"name":"sys","external_name":"sys","restriction":"CrystalWamr::Sys"},{"name":"functions","external_name":"functions","restriction":""},{"name":"index","external_name":"index","restriction":""},{"name":"output","external_name":"output","restriction":""},{"name":"path","external_name":"path","restriction":""}],"args_string":"(value : Nil, variable : String, sys : CrystalWamr::Sys, functions, index, output, path)","args_html":"(value : Nil, variable : String, sys : <a href=\"../CrystalWamr/Sys.html\">CrystalWamr::Sys</a>, functions, index, output, path)","location":{"filename":"src/crystal_wamr.cr","line_number":62,"url":null},"def":{"name":"function_args","args":[{"name":"value","external_name":"value","restriction":"Nil"},{"name":"variable","external_name":"variable","restriction":"String"},{"name":"sys","external_name":"sys","restriction":"CrystalWamr::Sys"},{"name":"functions","external_name":"functions","restriction":""},{"name":"index","external_name":"index","restriction":""},{"name":"output","external_name":"output","restriction":""},{"name":"path","external_name":"path","restriction":""}],"visibility":"Public","body":"x = [] of Int32\nif variable == \"$URL\"\n  if ((/\\d*/).match(path)).to_s != \"\"\n    a = path.scan(/\\d*/)\n    a.each do |v|\n      if v.to_s == \"\"\n      else\n        x << v.to_s.to_i\n      end\n    end\n  else\n    x = [0, 0, 0, 0, 0]\n  end\nend\nnative_functions(sys, functions, index, x)\n"}},{"html_id":"function_args(value:Nil,variable:String,sys:Nil,functions,index,output,path)-instance-method","name":"function_args","abstract":false,"args":[{"name":"value","external_name":"value","restriction":"Nil"},{"name":"variable","external_name":"variable","restriction":"String"},{"name":"sys","external_name":"sys","restriction":"Nil"},{"name":"functions","external_name":"functions","restriction":""},{"name":"index","external_name":"index","restriction":""},{"name":"output","external_name":"output","restriction":""},{"name":"path","external_name":"path","restriction":""}],"args_string":"(value : Nil, variable : String, sys : Nil, functions, index, output, path)","args_html":"(value : Nil, variable : String, sys : Nil, functions, index, output, path)","location":{"filename":"src/crystal_wamr.cr","line_number":77,"url":null},"def":{"name":"function_args","args":[{"name":"value","external_name":"value","restriction":"Nil"},{"name":"variable","external_name":"variable","restriction":"String"},{"name":"sys","external_name":"sys","restriction":"Nil"},{"name":"functions","external_name":"functions","restriction":""},{"name":"index","external_name":"index","restriction":""},{"name":"output","external_name":"output","restriction":""},{"name":"path","external_name":"path","restriction":""}],"visibility":"Public","body":"output[index] = variable"}},{"html_id":"function_args(value:Nil,variable:String|Nil,sys:Nil,functions,index,output,path)-instance-method","name":"function_args","abstract":false,"args":[{"name":"value","external_name":"value","restriction":"Nil"},{"name":"variable","external_name":"variable","restriction":"String | ::Nil"},{"name":"sys","external_name":"sys","restriction":"Nil"},{"name":"functions","external_name":"functions","restriction":""},{"name":"index","external_name":"index","restriction":""},{"name":"output","external_name":"output","restriction":""},{"name":"path","external_name":"path","restriction":""}],"args_string":"(value : Nil, variable : String | Nil, sys : Nil, functions, index, output, path)","args_html":"(value : Nil, variable : String | Nil, sys : Nil, functions, index, output, path)","location":{"filename":"src/crystal_wamr.cr","line_number":81,"url":null},"def":{"name":"function_args","args":[{"name":"value","external_name":"value","restriction":"Nil"},{"name":"variable","external_name":"variable","restriction":"String | ::Nil"},{"name":"sys","external_name":"sys","restriction":"Nil"},{"name":"functions","external_name":"functions","restriction":""},{"name":"index","external_name":"index","restriction":""},{"name":"output","external_name":"output","restriction":""},{"name":"path","external_name":"path","restriction":""}],"visibility":"Public","body":""}},{"html_id":"function_args(value:Nil,variable:String|Nil,sys,functions,index,output,path)-instance-method","name":"function_args","abstract":false,"args":[{"name":"value","external_name":"value","restriction":"Nil"},{"name":"variable","external_name":"variable","restriction":"String | ::Nil"},{"name":"sys","external_name":"sys","restriction":""},{"name":"functions","external_name":"functions","restriction":""},{"name":"index","external_name":"index","restriction":""},{"name":"output","external_name":"output","restriction":""},{"name":"path","external_name":"path","restriction":""}],"args_string":"(value : Nil, variable : String | Nil, sys, functions, index, output, path)","args_html":"(value : Nil, variable : String | Nil, sys, functions, index, output, path)","location":{"filename":"src/crystal_wamr.cr","line_number":59,"url":null},"def":{"name":"function_args","args":[{"name":"value","external_name":"value","restriction":"Nil"},{"name":"variable","external_name":"variable","restriction":"String | ::Nil"},{"name":"sys","external_name":"sys","restriction":""},{"name":"functions","external_name":"functions","restriction":""},{"name":"index","external_name":"index","restriction":""},{"name":"output","external_name":"output","restriction":""},{"name":"path","external_name":"path","restriction":""}],"visibility":"Public","body":""}},{"html_id":"return_hash-instance-method","name":"return_hash","abstract":false,"location":{"filename":"src/crystal_wamr.cr","line_number":34,"url":null},"def":{"name":"return_hash","visibility":"Public","body":"return @hash"}}],"macros":[{"html_id":"return_string(file,func,max_word_length=16)-macro","name":"return_string","abstract":false,"args":[{"name":"file","external_name":"file","restriction":""},{"name":"func","external_name":"func","restriction":""},{"name":"max_word_length","default_value":"16","external_name":"max_word_length","restriction":""}],"args_string":"(file, func, max_word_length = 16)","args_html":"(file, func, max_word_length = <span class=\"n\">16</span>)","location":{"filename":"src/crystal_wamr.cr","line_number":38,"url":null},"def":{"name":"return_string","args":[{"name":"file","external_name":"file","restriction":""},{"name":"func","external_name":"func","restriction":""},{"name":"max_word_length","default_value":"16","external_name":"max_word_length","restriction":""}],"visibility":"Public","body":"        string = \"\"\n      \n{% for i in (0..max_word_length) %}\n            char = wasm.exec_once({{ file }}, {{ func }}, [{{ i }}])\n            string += char.not_nil!.unsafe_chr\n      {% end %}\n\n        is_last_char_nil = string.byte_index '\\u0000'\n\n        if is_last_char_nil == nil\n        p string\n        \nelse\n        last = is_last_char_nil\n        last_char = last.not_nil! - 1\n        p string[0..last_char]\n        \nend\n    \n"}}]}]}]}})